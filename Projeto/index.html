<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Givanotacoes</title>
    <link rel="stylesheet" href="CSS/style.css" type="text/css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">


</head>

<body class="fundo">

    <nav class="nav-p p-3 bg-light d-flex justify-content-between align-items-center">
        <span class="logo text-center fw-bold fs-4">Givanotações</span>


        <!--Botoes de criar post-it e bloco de notas.-->
        <div class="dropdown text-center">
            <button class="btn btn-success dropdown-toggle" type="button" data-bs-toggle="dropdown"
                aria-expanded="false">
                <i class="fa-solid fa-plus"></i> Criar
            </button>

            <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="#" onclick="criarBloco(); return false;">Bloco de notas</a></li>
                <li><a class="dropdown-item" href="#" onclick="abrirModal('postit'); return false;">Post-it</a></li>

            </ul>
        </div>
    </nav>

    <div class="nav_lateral">
        <ul class="ul_nav_lateral icone_lateral  ">
            <li><i class="fa-solid fa-house "></i>
                <a href="index.html" class="link_la">
                    <span>Pagina inicial</span>
                </a>
            </li>
            <li><i class="fa-solid fa-circle-check"></i>
                <a href="lista_tarefas.html " class="link_la">
                    <span> Tarefas concluidas</span>
                </a>
            </li>
            <li><i class="fa-solid fa-bullseye"></i>
                <a href="metas.html" class="link_la">
                    <span>Metas</span>
                </a>
            </li>

        </ul>
    </div>
    <div class="container text-center rounded-4 mt-5 p-4">
        <!--Botoes de salvar, deletar, deletar selecionado e carregar tudo.-->
        <button type="button" class="btn btn-primary mb-3" onclick="salvarTudo()"> <i
                class="fa-solid fa-floppy-disk"></i> Salvar Tudo</button>
        <button class="btn btn-success mb-3 ms-2" onclick="carregarTudo()"><i class="fa-solid fa-rotate-right"></i>
            Carregar Tudo</button>
        <div class="dropdown d-inline">
            <button class="btn btn-danger dropdown-toggle mb-3 ms-2" type="button" id="dropdownDeletar"
                data-bs-toggle="dropdown" aria-expanded="false"><i class="fa-solid fa-trash"></i> Deletar
            </button>
            <ul class="dropdown-menu" aria-labelledby="dropdownDeletar">
                <li><a class="dropdown-item" href="#" onclick="DeletarTudo(); return false;">Deletar Tudo</a></li>
                <li><a class="dropdown-item" href="#" onclick="ativarModoSelecao(); return false;">Selecionar Itens</a>
                </li>
            </ul>
        </div>
       

        <div id="area-blocos" class="mt-4 d-flex flex-wrap gap-3 justify-content-center">
            <!-- Área onde os blocos vão aparecer -->
        </div>
    </div>
    <div class="container text-center  rounded-4 mt-5 p-4">
        <div id="area-categoria" class="mt-4 d-flex flex-wrap gap-3 justify-content-center">
            <!--Area onde as categorias irão aparecer-->


        </div>
    </div>

    <div class="modal fade" id="modalPersonalizar" tabindex="-1" aria-labelledby="modalPersonalizarLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title fw-bold" id="modalPersonalizarLabel">Personalizar</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body">

                    <!-- titulo ou texto inicial-->
                    <div class="mb-3">
                        <label for="tituloInput" class="form-label">Título/texto inicial</label>
                        <input type="text" class="form-control text-center fw-bold fs-5" id="tituloInput"
                            placeholder="Digite um titulo ou texto inicial...">
                    </div>

                    <!-- cor de fundo-->
                    <div class="mb-3">
                        <label for="corInput" class="form-label">Cor de Fundo</label>
                        <input type="color" class="form-control form-control-color" id="corInput" value="#ffeb3b">
                    </div>

                    <!-- cor do texto-->
                    <div class="mb-3">
                        <label for="corTextoInput" class="form-label">Cor do Texto</label>
                        <input type="color" class="form-control form-control-color" id="corTextoInput" value="#000000">
                    </div>

                    <!-- Pré-visualização -->
                    <div class="p-3 rounded-3 border mt-4" id="previewBox"
                        style="background-color: #ffeb3b; color: #000; font-weight: bold; text-align: center;">
                        <span id="previewTitulo">Pré-visualização do título</span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="btnCriarItem">Criar</button>
                </div>
            </div>
        </div>
    </div>



    <script>
        let tipoAtual = '';

        function criarBloco(valor = '') {
            const area = document.getElementById('area-blocos');
            const bloco = document.createElement('textarea');
            bloco.className = 'bloco form-control';
            bloco.placeholder = 'Digite aqui...';
            bloco.style.width = '300px';
            bloco.style.height = '200px';
            bloco.style.border = '1px black solid';
            bloco.value = valor;
            bloco.draggable = true;
            bloco.id = 'bloco-' + Date.now();

            bloco.addEventListener('dragstart', e => {
                e.dataTransfer.setData('id', bloco.id);
            });

            area.appendChild(bloco);
        }

        function criarPostIt(titulo = 'Novo Post-it', corFundo = '#fff35c', corTexto = '#000000') {
            const area = document.getElementById('area-blocos');
            const postIt = document.createElement('div');
            postIt.className = 'postit';
            postIt.contentEditable = true;
            postIt.textContent = titulo;
            postIt.draggable = true;
            postIt.dataset.id = 'postit-' + Date.now() + '-' + Math.floor(Math.random() * 1000);
            postIt.id = postIt.dataset.id;

            // aparência do post-it
            postIt.style.width = '150px';
            postIt.style.height = '150px';
            postIt.style.padding = '10px';
            postIt.style.boxShadow = '2px 2px 5px rgba(0,0,0,0.3)';
            postIt.style.backgroundColor = corFundo;
            postIt.style.display = 'inline-block';
            postIt.style.margin = '10px';
            postIt.style.overflow = 'hidden';
            postIt.style.color = corTexto;

            // rotação aleatória
            const rotacao = (Math.random() * 6 - 3).toFixed(1);
            postIt.style.transform = `rotate(${rotacao}deg)`;
            postIt.style.transition = 'transform 0.2s ease';

            postIt.addEventListener('dragstart', e => {
                e.dataTransfer.setData('id', postIt.id);
            });

            // limite de caracteres
            const limiteCaracteres = 80;
            postIt.addEventListener('input', () => {
                if (postIt.textContent.length > limiteCaracteres) {
                    postIt.textContent = postIt.textContent.slice(0, limiteCaracteres);
                    const range = document.createRange();
                    const sel = window.getSelection();
                    range.selectNodeContents(postIt);
                    range.collapse(false);
                    sel.removeAllRanges();
                    sel.addRange(range);
                }
            });

            area.appendChild(postIt);
        }

        function abrirModal(tipo) {
            tipoAtual = tipo;
            document.getElementById('tituloInput').value = '';
            document.getElementById('corInput').value = '#ffff00';
            document.getElementById('modalPersonalizarLabel').textContent = 'Criar Post-it';

            const modal = new bootstrap.Modal(document.getElementById('modalPersonalizar'));
            modal.show();
            window.modalAtivo = modal;
        }

        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('btnCriarItem').addEventListener('click', () => {
                const titulo = document.getElementById('tituloInput').value || 'Novo Post-it';
                const corFundo = document.getElementById('corInput').value;
                const corTexto = document.getElementById('corTextoInput').value;

                if (tipoAtual === 'postit') criarPostIt(titulo, corFundo, corTexto);

                if (window.modalAtivo) window.modalAtivo.hide();
            });
        });

        // Atualiza a pré-visualização em tempo real
        document.getElementById('tituloInput').addEventListener('input', () => {
            document.getElementById('previewTitulo').textContent =
                document.getElementById('tituloInput').value || 'Pré-visualização do título';
        });

        document.getElementById('corInput').addEventListener('input', () => {
            document.getElementById('previewBox').style.backgroundColor =
                document.getElementById('corInput').value;
        });

        document.getElementById('corTextoInput').addEventListener('input', () => {
            document.getElementById('previewBox').style.color =
                document.getElementById('corTextoInput').value;
        });

        function salvarTudo() {
            const blocos = [];

            document.querySelectorAll('.bloco').forEach(el => {
                blocos.push({
                    tipo: 'bloco',
                    conteudo: el.value
                });
            });

            document.querySelectorAll('.postit').forEach(el => {
                blocos.push({
                    tipo: 'postit',
                    id: el.dataset.id,
                    conteudo: el.textContent,
                    corFundo: el.style.backgroundColor || '',
                    corTexto: el.style.color || ''
                });
            });

            if (blocos.length === 0) {
                alert('Não há nada para salvar!');
                return;
            }

            localStorage.setItem('blocos', JSON.stringify(blocos));
            alert('Tudo foi salvo localmente!');
        }

        function carregarTudo() {
            const areaBlocos = document.getElementById('area-blocos');
            areaBlocos.innerHTML = '';

            const dados = JSON.parse(localStorage.getItem('blocos')) || [];

            dados.forEach(item => {
                if (item.tipo === 'bloco') criarBloco(item.conteudo);
                if (item.tipo === 'postit') criarPostIt(item.conteudo, item.corFundo || '#fff35c', item.corTexto || '#000000');
            });

            if (dados.length === 0) alert('Não há dados salvos!');
        }

        function DeletarTudo() {
            const dados = JSON.parse(localStorage.getItem('blocos')) || [];
            if (dados.length === 0) {
                alert('Não há dados para deletar!');
                return;
            }

            const confirmar = confirm("Tem certeza que deseja deletar tudo? Essa ação não pode ser desfeita.");
            if (!confirmar) return;

            document.getElementById('area-blocos').innerHTML = '';
            localStorage.removeItem('blocos');
            alert('Todos os blocos e post-its foram deletados!');
        }

        let modoSelecao = false;

        function ativarModoSelecao() {
            modoSelecao = !modoSelecao;
            const todosItens = document.querySelectorAll('.bloco, .postit');

            todosItens.forEach(item => {
                if (modoSelecao) {
                    item.style.cursor = 'pointer';
                    item.addEventListener('click', toggleSelecionado);
                } else {
                    item.style.cursor = 'default';
                    item.removeEventListener('click', toggleSelecionado);
                    item.classList.remove('selecionado');
                }
            });

            document.getElementById('btnConfirmarSelecao').style.display = modoSelecao ? 'inline-block' : 'none';
            alert(modoSelecao
                ? 'Modo de seleção ativado! Clique nos itens que deseja deletar.'
                : 'Modo de seleção desativado.');
        }

        function toggleSelecionado(event) {
            event.currentTarget.classList.toggle('selecionado');
        }

        function deletarSelecionados() {
            const selecionados = document.querySelectorAll('.selecionado');
            if (selecionados.length === 0) {
                alert('Nenhum item selecionado!');
                return;
            }

            if (!confirm('Tem certeza que deseja deletar os itens selecionados?')) return;

            selecionados.forEach(el => el.remove());

            const dados = JSON.parse(localStorage.getItem('blocos')) || [];
            const novosDados = dados.filter(item => {
                return ![...selecionados].some(sel => sel.textContent === item.conteudo);
            });

            localStorage.setItem('blocos', JSON.stringify(novosDados));

            document.getElementById('btnConfirmarSelecao').style.display = 'none';
            modoSelecao = false;

            alert('Itens selecionados foram deletados!');
        }

        // function voltarPrincipal() {
        //     const temp = document.getElementById('area-temp');
        //     if (!temp) return;

        //     const itens = temp.querySelectorAll('.bloco, .postit');
        //     itens.forEach(item => {
        //         document.getElementById('area-blocos').appendChild(item);
        //     });

        //     temp.remove();
        //     document.querySelector('.container').style.display = '';
        // }


    </script>





    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"></script>



</body>

</html>